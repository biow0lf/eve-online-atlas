!function(e,t){"use strict";e.module("restmod").factory("NestedDirtyModel",["restmod",function(t){function n(t){return e.isObject(t)&&!e.isArray(t)}function r(t){var n=t.$type,r={};return t.$each(function(t,i){var o=n.$$getDescription(i);o&&o.relation||(r[i]=e.copy(t))}),r}function i(e,t){for(var n,r=0;n=t[r++];)e&&(e=e.hasOwnProperty(n)?e[n]:null);return e}function o(t,n,r,o){var a=r.pop();return t=i(t,r),n=i(n,r),e.isObject(n)&&e.isObject(t)&&n.hasOwnProperty(a)?"function"==typeof o?!!o(t[a],n[a]):!e.equals(t[a],n[a]):!1}function a(e,t,r,i){var s,u=[];if(t)for(var l in t)t.hasOwnProperty(l)&&(n(t[l])&&n(e[l])?(s=a(e[l],t[l],r.concat([l]),i),u.push.apply(u,s)):o(e,t,[l],i)&&u.push(r.concat([l])));return u}function s(e){for(var t=0,n=e.length;n>t;t++)e[t]=e[t].join(".");return e}function u(t,n,r){var o=r.pop();t=i(t,r),n=i(n,r),n&&t&&n.hasOwnProperty(o)&&(t[o]=e.copy(n[o]))}return t.mixin(function(){this.on("after-feed",function(){this.$cmStatus=r(this)}).define("$dirty",function(t,n){var r=this.$cmStatus;return t&&!e.isFunction(t)?o(this,r,t.split("."),n):(e.isFunction(t)&&(n=t),s(a(this,r,[],n)))}).define("$restore",function(e){return this.$action(function(){var t=this.$cmStatus;if(e){var n=e.split(".");u(this,t,n)}else for(var r=a(this,t,[]),i=0,o=r.length;o>i;i++)u(this,t,r[i])})})})}])}(angular);